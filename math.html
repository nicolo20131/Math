<!DOCTYPE html>
<html lang="it">
<head>
    <meta charset="UTF-8">
    <title>MATH</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>
<div id="parteIniziale">
    <h1>Benvenuto/a in MATH! Scrivi l'operazione che vuoi fare. (Per vedere quelle supportate premi "supporti")</h1>
</div>
<div id="resto">
    <a href="supporto.html">supporti</a><br><br>

    <input type="text" id="risposta" placeholder="es: addizione, sottrazione frazioni">
    <button onclick="mostra()">Invia</button>

    <p id="risultato"></p>

    <!-- Input per numeri/frazioni e bottone calcola -->
    <p id="testoPrimoNumero" style="display:none;">Primo numero/frazione:</p>
    <input type="text" id="primoNumeroInput" style="display:none;"><br>

    <p id="testoSecondoNumero" style="display:none;">Secondo numero/frazione:</p>
    <input type="text" id="secondoNumeroInput" style="display:none;"><br>

    <button id="bottoneCalcola" style="display:none;" onclick="calcola()">Calcola</button>

    <p id="risultatoOperazione"></p>
</div>

<script>
let operazioneSelezionata = "";

function mostra() {
    let valore = document.getElementById("risposta").value.toLowerCase();
    operazioneSelezionata = valore;

    switch(valore) {
        case "addizione":
        case "sottrazione":
        case "moltiplicazione":
        case "divisione":
            document.getElementById("risultato").innerText = "Hai scelto: " + valore;
            break;
        case "addizione frazioni":
        case "sottrazione frazioni":
        case "moltiplicazione frazioni":
        case "divisione frazioni":
            document.getElementById("risultato").innerText = "Hai scelto: " + valore;
            break;
        default:
            document.getElementById("risultato").innerText = "Operazione non riconosciuta";
            return;
    }

    // Mostra input numeri/frazioni e bottone calcola
    document.getElementById("testoPrimoNumero").style.display = "block";
    document.getElementById("primoNumeroInput").style.display = "inline";
    document.getElementById("testoSecondoNumero").style.display = "block";
    document.getElementById("secondoNumeroInput").style.display = "inline";
    document.getElementById("bottoneCalcola").style.display = "inline";
}

function calcola() {
    let num1 = document.getElementById("primoNumeroInput").value;
    let num2 = document.getElementById("secondoNumeroInput").value;
    let risultato;

    if (operazioneSelezionata.includes("frazione")) {
        risultato = calcolaFrazioni(num1, num2, operazioneSelezionata);
    } else {
        let numero1 = parseFloat(num1);
        let numero2 = parseFloat(num2);
        switch (operazioneSelezionata) {
            case "addizione":
                risultato = numero1 + numero2;
                break;
            case "sottrazione":
                risultato = numero1 - numero2;
                break;
            case "moltiplicazione":
                risultato = numero1 * numero2;
                break;
            case "divisione":
                if (numero2 === 0) {
                    risultato = "Errore: divisione per zero!";
                } else {
                    risultato = numero1 / numero2;
                }
                break;
        }
    }

    document.getElementById("risultatoOperazione").innerText =
        "Risultato:\n" + risultato;

    // Reset automatico dopo 3 secondi
    setTimeout(resetPagina, 5500);
}

// Funzione per calcolare frazioni
function calcolaFrazioni(f1, f2, operazione) {
    let [num1, den1] = f1.split("/").map(Number);
    let [num2, den2] = f2.split("/").map(Number);

    if (den1 === 0 || den2 === 0) return "Errore: denominatore 0";

    let risNum, risDen;

    switch(operazione) {
        case "addizione frazioni":
            risDen = den1 * den2;
            risNum = num1 * den2 + num2 * den1;
            break;
        case "sottrazione frazioni":
            risDen = den1 * den2;
            risNum = num1 * den2 - num2 * den1;
            break;
        case "moltiplicazione frazioni":
            risNum = num1 * num2;
            risDen = den1 * den2;
            break;
        case "divisione frazioni":
            if (num2 === 0) return "Errore: divisione per zero";
            risNum = num1 * den2;
            risDen = den1 * num2;
            break;
    }

    // Riduzione della frazione
    function mcd(a,b){ return b==0 ? a : mcd(b,a%b); }
    let divisor = mcd(risNum, risDen);
    risNum /= divisor;
    risDen /= divisor;

    return risNum + "/" + risDen;
}

// Funzione per resettare la pagina senza ricaricarla
function resetPagina() {
    document.getElementById("risposta").value = "";
    document.getElementById("primoNumeroInput").value = "";
    document.getElementById("secondoNumeroInput").value = "";

    document.getElementById("testoPrimoNumero").style.display = "none";
    document.getElementById("primoNumeroInput").style.display = "none";
    document.getElementById("testoSecondoNumero").style.display = "none";
    document.getElementById("secondoNumeroInput").style.display = "none";
    document.getElementById("bottoneCalcola").style.display = "none";

    document.getElementById("risultato").innerText = "";
    document.getElementById("risultatoOperazione").innerText = "";

    operazioneSelezionata = "";
}
</script>
</body>
</html>
